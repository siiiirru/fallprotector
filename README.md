# 인공지능 낙상감지 시스템


* 전세계적으로 매년 약 684,000건의 치명적 낙상이 발생해 사망합니다. 사망 외 의료 처치가 필수적인 낙상 사고는 3730만 건이 발생하며, 노인들의 사망 및 중상 위험이 가장 높습니다. [1]
* 대한민국의 독거 노인 비율은 32.8%이기 때문에[2] 낙상 사고가 발생하더라도 신속한 의료 대응이 불가한 상황이 발생할 수 있습니다.
* 대한민국의 노인 낙상의 경우 71.1%의 비중으로 가정내에서 발생합니다. [3]
* 낙상 감지 방식 중 웨어러블 센서 기반 기술의 경우 높은 탐지율과 범용성을 보이나, 사용자의 착용불편으로 보편화되지 않고 있습니다. [4]
* 바닥에 설치하는 바닥 진동 센서를 통한 감지는 설치된 바닥 표면에만 사용가능하며 비용이 매우 비쌉니다. [5]
* 임베디드 시스템을 통해 제한적인 정보 전송으로 사생활 침해 문제를 해결하려 하였습니다.
* 낙상은 1.5s 만에 완료되는 현상으로, 낙상 감지를 위해서는 실시간으로 이미지 처리가 가능해야 합니다. [6]

####  이에 너머지키미팀은 문제해결을 위한 1차적 시도이자 캡스톤 프로젝트로써 독거노인 대상 인공지능을 이용한 비전 기반 주간 실시간 낙상 감지 임베디드 시스템을 제작하게 되었습니다.

## 사용 시나리오
- 장소:  광원이 있는 주거지
- 대상: 독거노인
- 시간: 수면시간을 제외한 활동 시간
- 시나리오: 생활공간을 계속해서 촬영 중 낙상으로 의심되는 움직임이 탐지되었을 경우 스켈레톤을 포함한 낙상발생 알림 전송

## 사용한 하드웨어 사양
- 임베디드 기기:  8GB RAM, - RaspberryPi5 with active cooler(quad-core Arm Cortex A76 processor @ 2.4GHz)
- 카메라:  RaspberryPi camera module V2, 8MP

## 시스템 구동 흐름
1. 카메라 영상 생성
2. mediapipe로 스켈레톤 데이터 생성
3. XGBoost 낙상예측+추가 낙상조건으로 최종 낙상 감지

## XGBoost 학습
- ROSE lab의 "NTU RGB+D" Dataset 사용
- MideaPipe로 추출한 관절좌표값을 라벨링
- 낙상, 비낙상 1:1비율의 총 49,989개 관절값 CSV 사용
- 학습, 검증, 테스트데이터 6:2:2 로 분류하여 학습
- 학습된 모델의 정확도 98.1%, 정밀도 0.97, 재현율 0.96, F1 score 0.97

## 알고리즘 상세 설명
1. RaspberryPi5에 연결된 카메라를 통해 실시간 영상캡쳐
2. MediaPipe로 1인의 33쌍의 관절좌표값을 추출
3. 추출된 좌표로 1차 낙상 검증 (검증 실패 시 1번 과정으로)
- 코의 y좌표가 이전 프레임의 코y좌표보다 내려감
- 코의 y좌표가 이동한 거리가 이미지 높이*{(코와 발목 y좌표간의 거리/이미지높이)*2.35*0.2} 이상임 (이미지 높이의 0.2이상 이동하되 사람과 카메라간의 거리를 고려)
4. XGBoost로 낙상, 비낙상 여부 예측
5. XGBoost 예측 결과값이 0.6 이상이면 최종 낙상 판정
6. 보호자에게 관절이미지와 함께 낙상 발생 알림 메일 전송

## 실제 테스트 결과
- 6개 시나리오로 테스트
 비낙상 (청소, 국민체조, 물건정리, 휴식)
 낙상 (일반 낙상, 배경에 사람 그림)
- 1920*1080 해상도, 3.75fps
- 비낙상 총 11분 중 1회(쓰레기 줍기 장면) 제외 모두 비낙상으로 감지
- 낙상 총 10회 낙상 중 1회 제외 모두 낙상으로 감지
- 낙상 발생 시 관절이미지와 함께 낙상 알림 메일 전송 확인


-----
참고문헌

[1] World Health Organization. (2021). Falls.
<br>[2] 보건복지부. (2024). 2023년 노인실태조사 결과 발표. 
<br>[3] 류정민. (2016). 한국형 노인 낙상 예방 가이드라인 개발. 
<br>[4] 강윤규, 강희용, & 원달수. (2021). PoseNet과 GRU를 이용한 Skeleton Keypoints 기반 낙상 감지.
<br>[5] Harrou, F., Zerrouki, N., Sun, Y., & Houacine, A. (2017). Vision-based fall detection system for improving safety of elderly people. 
<br>[6] Lu, K.-L., & Chu, E. T.-H. (2018). An Image-Based Fall Detection System for the Elderly.

